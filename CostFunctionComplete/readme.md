This contains the complete code for cost function
